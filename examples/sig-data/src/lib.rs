use hex_literal::hex;

macro_rules! entries {
    ($( $pubkey:literal $signature:literal $message:literal, )*) => {
        [$( (hex!($pubkey), hex!($signature), hex!($message)), )*]
    };
    ($( $pubkey:literal $signature:literal &$message:literal, )*) => {
        [$( (hex!($pubkey), hex!($signature), &hex!($message)), )*]
    };
}

pub type Pubkey = [u8; 32];
pub type Signature = [u8; 64];
pub type Message = [u8; 112];

/// Example Tendermint block signatures.
pub static ENTRIES: [(Pubkey, Signature, Message); 20] = entries! [
    "b306465cc3b4a7ef4a22e52aadfc6139f43b24ee3f1ced5e7e282a8438133a9d" "77cb080c6fe05928f39c1d7c6abcac9ffcf2cb0fb757fe011b42f35a745d8b485cb888a2f30d7ac2bc4f4a19237cda5643a3ff7d827b87f86d0b40d89c02930c" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610bbcff5bc03320a63656e74617572692d31",
    "de3ae1e6b2ff70d1aba314cfa198dff5e39be16c1630ceee584b04dd0a9317c6" "2638a4f3f14504819d1b79e7b0b80aeb0420c2bc3c0562d004f01cf764b113feac9f1e2b9da26c58b11585bbc931038026b9410caafefc28cc8b6a20d9e9ce00" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b6061094a9fbc203320a63656e74617572692d31",
    "a2f06c0437d8fab9e217d24d18961c72ec74c7384255b113136ec3ef49865fae" "7797ddcd834b03f6b21589545d145bee72e1ace774d9f0b5c587282ce6710d3f3667d4a74e760732136b4874bfdcdfb2d648ed460cd3f1fa39b09550f1150e05" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610d587fac203320a63656e74617572692d31",
    "f7cc7ac1bcdfbdefc2c6ad9edce15fd20d4d168935b194a8ffa7e713b924c97a" "f50ab3190ba72df4cacb104a0f72759980829cfcb6604aba23f4d8c5def3704520c7de94f3a248908ee002426ce7b2268a2c5744207b31a2723eeccaa28a7b04" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610f8fe95cd03320a63656e74617572692d31",
    "96ca55c01b34f916e30816f24d31c86dda045ded151a01f5c65fa24aead95784" "561cecd9107f321911a476f398485d3c9ec6955225b6a69087d37e986791ed9018068a1450d4000ab088036a71c7ca5bb09a09de83132374ba642e36b82bde08" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610fe83eebd03320a63656e74617572692d31",
    "c70e3eb811c173526053ff36535d04ab0442a2f84fab98a7b6f01bb9bdf4c24e" "5152a9b1d64e6b90651c1bbdd37ce7487c0655bb2a128a376ff2e11849777da70e5e194c69c2158f578600492f4cb77a913726b7a4921317cc08bd7244a32b00" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610b9b3e2c303320a63656e74617572692d31",
    "0f2c53c23160cab8f376d8c7f2a0de5cb240d254fb53aaa3f36b358443489df0" "ab811758b9558ff582ab25f8e209e78668cfcab7d2248a8d9ede499165de6d46357e0af003c42ce0f554fa317689ad1e4340cba17424471aeb86fe9707e70b06" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610b6aea4bd03320a63656e74617572692d31",
    "126533d8afd0551a142b07561420b72dc975d8aaa257449b3dae88de7df9515e" "49b58f5f28a01da51d5e3ae150246bdb1f7daf0b0e948ba6bc7a8be1d6bf54320d1652315742b83dbe6e52266997d411a9ea3a6c3a54eb3cc0143a8ec71fae00" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b606108084f7b803320a63656e74617572692d31",
    "e38c340276e1110a30c6a0c6105a1c5ca2350019bb1e62245a68e0675486b362" "f2a0faea4bc921db91bc7bef9a61925bd69aa4cf6905a7d44b39174633405056ef0d6c3f3df395ab5298381cd06a8e816581f7e83543dcea1870285b2ca20605" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c0890f1d2b606108080808001320a63656e74617572692d31",
    "8287d47d30fc58a7de7ec1eb7564f21127d6c749dde689da47da03b67c72a341" "576c5e85604db3ad7ea7117351fe2a4823f9ec53f2eea0e00cce6718dfcacabd7775baeb399cc006de000622cacb544732a05adf187f915fc558a78b04ae9103" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b6061089f8d89a03320a63656e74617572692d31",
    "69e78fe4ee08443efa15f293c6d7905d559296f8e73c298cd952b8b0114f8f43" "f1d93c14b1a5de18d31290c016f8a81c5db2837ea86af58dafa277c031e60b8e3ee15b5409152032d21654b4a0bf18c7cab317aca0bce5803390b790c99d8900" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c0890f1d2b606108080808001320a63656e74617572692d31",
    "e212641e3c66147f60f3789b28f550075ac6f37a6106044f399c564d73a9635e" "00bd86a5c6ba1b113364b8dd250cf04ee9b76d618333fb3b0796b1ebc068ff67eb816dfd607c0b941f217586f0606dff8cfe01425fd12d9fec83fc52a8ae280a" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610b1d3ad9b03320a63656e74617572692d31",
    "f800169385f9594f5114a4fbeb9156ce3e140e1b3a7cd62b052e470ac92c6ca8" "14132857f3cb9bc8a3ed328c388988579e9bdcd2de3e606c58352ef42495a3ab21b72251e0831d09bb9a29daf2bce9cadcadd0c407edf629edd95314b7d79902" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610d787efb703320a63656e74617572692d31",
    "831cd0dd1c64270563124ef249434a5064d1208aac77353e43309a76c289b5b1" "923418fcd73cc9f20e5cddcbecf130f953998bfc6b49b44e8fd096aae8ba4605f403382f9b369c9da48af991362527ff8d350fc1a3e75546ccd086c73d133d02" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610eee5edbd03320a63656e74617572692d31",
    "06b037916dd0fc91ecb2810d4b08a022d3cf3d4113b4c91f775a20fc5add2dc9" "9bb81cf3711e31605f732477677f30bf733363040ad2d4c26ad5ae833517599dd7dd4d19c03351a6fed8e22b7c36b8fd321f6a2aa9f0c1d15fe2a90095adc208" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c0890f1d2b606108080808001320a63656e74617572692d31",
    "c57ae8cef5e86c4e08a3906f8cd7d63c108fcb0fdb2b7a786c25849b463719d7" "941f16f3b1b224ea9d8ebb8de7e6be8ac778ef320ac95533c5684a8844f07cd55662a43bbc9768a4d4cca0b36f204d0eab2e48a77e569b4b27664ff96820f90c" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610ebbdd5bd03320a63656e74617572692d31",
    "f0eaee590ccbb413aca15bdcb7b46b75227775e0c9450b39b30887b7d29ed62f" "410fb5296e222044b728570b58d22fc454defbbb2634e35e5cb7b315e72a2c69e1c520d71eb297d2bdb553be2b0c96edc3bf68d197edd5dcf5ac2ae77d22ea0c" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610ca9fc9bc03320a63656e74617572692d31",
    "3ff89e9e632f96572bc4a1c59d0a3e64a3137e83a963a343538b3f32178585d9" "e70057dce709dd55a113c57ae4695a532a96176a7b23e50a36673d4e2b98931a069ba4b946fe66d722b54fb205be2bcd753eeb78914d1907a1e444a9f2fb7e07" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610b4e5d7da03320a63656e74617572692d31",
    "dd09778d68063be0f5afa4ffc631d27588606baf720bb6f73c42475088f83968" "9a925d95a8b853562d9664573ae5f162ea9165c4f4a7350b91515c13f6ce06f9f42d5b1fe3ba84f79af8a5c326ffc44afe0f3db0d8f81edfc3d6d3549f95ad0e" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610f1e3a7b203320a63656e74617572692d31",
    "a94cb739b8737a6791b378be67384eace10ac61ed41150a37a99c16d0d938cb0" "05f4f61522133d8a44ed47f1f654ee95424c298c98deb4fd6ca452a53533d8f889550c82bddba5acd48255dafd8512e7f4792be18c6ce7a722247ef07ef04901" "6f080211f57b68000000000022480a2024d2e36a3452abf748de0d265ac6decb5d958156bdc5364226abc6dd7624640f122408011220319e1fdb0e76a8bec3de0dbb48a21607c4073fcc1ccc8fe712b0f96b22a4f3892a0c088ff1d2b60610bfcba6be03320a63656e74617572692d31",
];

/// Ed25519 test vectors.
///
/// https://datatracker.ietf.org/doc/html/rfc8032#section-7.1 sans the 1024 case
/// since itâ€™s too long.
pub static TESTS: [(Pubkey, Signature, &[u8]); 4] = entries! [
    "d75a980182b10ab7d54bfed3c964073a0ee172f3daa62325af021a68f707511a" "e5564300c360ac729086e2cc806e828a84877f1eb8e5d974d873e065224901555fb8821590a33bacc61e39701cf9b46bd25bf5f0595bbe24655141438e7a100b" &"",
    "3d4017c3e843895a92b70aa74d1b7ebc9c982ccf2ec4968cc0cd55f12af4660c" "92a009a9f0d4cab8720e820b5f642540a2b27b5416503f8fb3762223ebdb69da085ac1e43e15996e458f3613d0f11d8c387b2eaeb4302aeeb00d291612bb0c00" &"72",
    "fc51cd8e6218a1a38da47ed00230f0580816ed13ba3303ac5deb911548908025" "6291d657deec24024827e69c3abe01a30ce548a284743a445e3680d7db5ac3ac18ff9b538d16f290ae67f760984dc6594a7c15e9716ed28dc027beceea1ec40a" &"af82",
    "ec172b93ad5e563bf4932c70e1245034c35467ef2efd4d64ebf819683467e2bf" "dc2a4459e7369633a52b1bf277839a00201009a3efbf3ecb69bea2186c26b58909351fc9ac90b3ecfdfbc7c66431e0303dca179c138ac17ad9bef1177331a704" &"ddaf35a193617abacc417349ae20413112e6fa4e89a97ea20a9eeee64b55d39a2192992a274fc1a836ba3c23a3feebbd454d4423643ce80e2a9ac94fa54ca49f",
];


#[test]
fn check_entries() {
    for (i, (pubkey, signature, message)) in ENTRIES.iter().enumerate() {
        let pubkey = ed25519_dalek::PublicKey::from_bytes(pubkey).unwrap();
        let signature =
            ed25519_dalek::Signature::from_bytes(signature).unwrap();
        if let Err(err) = pubkey.verify_strict(message, &signature) {
            panic!("#{i}: {err}")
        }
    }
}

#[test]
fn check_tests() {
    for (i, (pubkey, signature, message)) in TESTS.iter().enumerate() {
        let pubkey = ed25519_dalek::PublicKey::from_bytes(pubkey).unwrap();
        let signature =
            ed25519_dalek::Signature::from_bytes(signature).unwrap();
        if let Err(err) = pubkey.verify_strict(message, &signature) {
            panic!("#{i}: {err}")
        }
    }
}
